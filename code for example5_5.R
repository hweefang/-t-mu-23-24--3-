#R code
#generate the results as illustrated in code 3 & code 4
#check for $(t,\mu)=(23,-3), (24,-3)$ and $(t,\mu)=(23,-4), (24,-4)$

mu=-3
#SRG parameters
miu_array=c(85, 14, 3, 2, 4, 45, 12, 3, 3, 3, 231, 30, 9, 3, 9, 26, 10, 3, 4, 2, 126, 25, 8, 4, 7, 69, 20, 7, 5, 5, 25, 12, 5, 6, 2, 36, 15, 6, 6, 3, 49, 18, 7, 6, 4, 64, 21, 8, 6, 5, 81, 24, 9, 6, 6, 100, 27, 10, 6, 7, 121, 30, 11, 6, 8, 144, 33, 12, 6, 9, 169, 36, 13, 6, 10, 196, 39, 14, 6, 11, 225, 42, 15, 6, 12, 256, 45, 16, 6, 13, 289, 48, 17, 6, 14, 324, 51, 18, 6, 15, 361, 54, 19, 6, 16, 400, 57, 20, 6, 17, 441, 60, 21, 6, 18, 484, 63, 22, 6, 19, 529, 66, 23, 6, 20, 26, 15, 8, 9, 2, 35, 18, 9, 9, 3, 57, 24, 11, 9, 5, 70, 27, 12, 9, 6, 100, 33, 14, 9, 8, 117, 36, 15, 9, 9, 155, 42, 17, 9, 11, 176, 45, 18, 9, 12, 222, 51, 20, 9, 14, 247, 54, 21, 9, 15, 301, 60, 23, 9, 17, 330, 63, 24, 9, 18, 392, 69, 26, 9, 20, 425, 72, 27, 9, 21, 495, 78, 29, 9, 23, 532, 81, 30, 9, 24, 610, 87, 32, 9, 26, 651, 90, 33, 9, 27, 737, 96, 35, 9, 29, 36, 21, 12, 12, 3, 441, 88, 35, 13, 25, 76, 35, 18, 14, 7, 99, 42, 21, 15, 9, 189, 60, 27, 15, 15, 575, 112, 45, 16, 32, 40, 27, 18, 18, 3, 96, 45, 24, 18, 9, 49, 32, 21, 20, 4, 232, 77, 36, 20, 19, 75, 42, 25, 21, 7, 261, 84, 39, 21, 21, 375, 102, 45, 21, 27, 105, 52, 29, 22, 10, 76, 45, 28, 24, 7, 126, 60, 33, 24, 12, 162, 69, 36, 24, 15, 1344, 221, 88, 26, 65, 95, 54, 33, 27, 9, 196, 81, 42, 27, 18, 1911, 270, 105, 27, 81, 476, 133, 60, 28, 35, 57, 42, 31, 30, 4, 64, 45, 32, 30, 5, 96, 57, 36, 30, 9, 288, 105, 52, 30, 25, 540, 147, 66, 30, 39, 225, 96, 51, 33, 21, 405, 132, 63, 33, 33, 176, 85, 48, 34, 17, 703, 182, 81, 35, 49, 841, 200, 87, 35, 55, 50, 42, 35, 36, 2, 56, 45, 36, 36, 3, 76, 54, 39, 36, 6, 125, 72, 45, 36, 12, 154, 81, 48, 36, 15, 300, 117, 60, 36, 27, 550, 162, 75, 36, 42, 126, 75, 48, 39, 12, 81, 60, 45, 42, 6, 120, 77, 52, 44, 11, 351, 140, 73, 44, 32, 77, 60, 47, 45, 5, 105, 72, 51, 45, 9, 175, 102, 65, 51, 17, 112, 81, 60, 54, 9, 176, 105, 68, 54, 17, 276, 135, 78, 54, 27, 100, 77, 60, 56, 7, 162, 105, 72, 60, 15, 243, 132, 81, 60, 24, 253, 140, 87, 65, 25,275, 162, 105, 81, 27)

mu=-4 
#SRG parameters
miu_array=c(56, 10, 0, 2, 2, 99, 14, 1, 2, 3, 300, 26, 4, 2, 6, 736, 42, 8, 2, 10, 875, 46, 9, 2, 11, 1961, 70, 15, 2, 17, 162, 23, 4, 3, 5, 430, 39, 8, 3, 9, 40, 12, 2, 4, 2, 96, 20, 4, 4, 4, 133, 24, 5, 4, 5, 280, 36, 8, 4, 8, 736, 60, 14, 4, 14, 1408, 84, 20, 4, 20, 2300, 121, 30, 5, 29, 36, 14, 4, 6, 2, 136, 30, 8, 6, 6, 351, 50, 13, 6, 11, 1596, 110, 28, 6, 26, 3250, 171, 44, 7, 41, 35, 16, 6, 8, 2, 176, 40, 12, 8, 8, 50, 21, 8, 9, 3, 540, 77, 22, 9, 17, 85, 30, 11, 10, 5, 364, 66, 20, 10, 14, 236, 55, 18, 11, 11, 36, 20, 10, 12, 2, 49, 24, 11, 12, 3, 64, 28, 12, 12, 4, 81, 32, 13, 12, 5, 100, 36, 14, 12, 6, 121, 40, 15, 12, 7, 144, 44, 16, 12, 8, 169, 48, 17, 12, 9, 196, 52, 18, 12, 10, 225, 56, 19, 12, 11, 256, 60, 20, 12, 12, 289, 64, 21, 12, 13, 324, 68, 22, 12, 14, 361, 72, 23, 12, 15, 400, 76, 24, 12, 16, 441, 80, 25, 12, 17, 484, 84, 26, 12, 18, 529, 88, 27, 12, 19, 576, 92, 28, 12, 20, 625, 96, 29, 12, 21, 676, 100, 30, 12, 22, 729, 104, 31, 12, 23, 784, 108, 32, 12, 24, 841, 112, 33, 12, 25, 900, 116, 34, 12, 26, 961, 120, 35, 12, 27, 1024, 124, 36, 12, 28, 1089, 128, 37, 12, 29, 1156, 132, 38, 12, 30, 1225, 136, 39, 12, 31, 1296, 140, 40, 12, 32, 1369, 144, 41, 12, 33, 1444, 148, 42, 12, 34, 1521, 152, 43, 12, 35, 1600, 156, 44, 12, 36, 1681, 160, 45, 12, 37, 1764, 164, 46, 12, 38, 1849, 168, 47, 12, 39, 1936, 172, 48, 12, 40, 2025, 176, 49, 12, 41, 2116, 180, 50, 12, 42, 2209, 184, 51, 12, 43, 2304, 188, 52, 12, 44, 2401, 192, 53, 12, 45, 2500, 196, 54, 12, 46, 2601, 200, 55, 12, 47, 2704, 204, 56, 12, 48, 2809, 208, 57, 12, 49, 2916, 212, 58, 12, 50, 3025, 216, 59, 12, 51, 3136, 220, 60, 12, 52, 3249, 224, 61, 12, 53, 3364, 228, 62, 12, 54, 3481, 232, 63, 12, 55, 3600, 236, 64, 12, 56, 3721, 240, 65, 12, 57, 3844, 244, 66, 12, 58, 3969, 248, 67, 12, 59, 4096, 252, 68, 12, 60, 4225, 256, 69, 12, 61, 4356, 260, 70, 12, 62, 4489, 264, 71, 12, 63, 4624, 268, 72, 12, 64, 4761, 272, 73, 12, 65, 4900, 276, 74, 12, 66, 5041, 280, 75, 12, 67, 5184, 284, 76, 12, 68, 5329, 288, 77, 12, 69, 5476, 292, 78, 12, 70, 5625, 296, 79, 12, 71, 5776, 300, 80, 12, 72, 5929, 304, 81, 12, 73, 6084, 308, 82, 12, 74, 6241, 312, 83, 12, 75, 6400, 316, 84, 12, 76, 6561, 320, 85, 12, 77, 50, 28, 15, 16, 3, 63, 32, 16, 16, 4, 111, 44, 19, 16, 7, 130, 48, 20, 16, 8, 196, 60, 23, 16, 11, 221, 64, 24, 16, 12, 305, 76, 27, 16, 15, 336, 80, 28, 16, 16, 438, 92, 31, 16, 19, 475, 96, 32, 16, 20, 595, 108, 35, 16, 23, 638, 112, 36, 16, 24, 776, 124, 39, 16, 27, 825, 128, 40, 16, 28, 981, 140, 43, 16, 31, 1036, 144, 44, 16, 32, 1210, 156, 47, 16, 35, 1271, 160, 48, 16, 36, 1463, 172, 51, 16, 39, 1530, 176, 52, 16, 40, 1740, 188, 55, 16, 43, 1813, 192, 56, 16, 44, 2041, 204, 59, 16, 47, 2120, 208, 60, 16, 48, 2366, 220, 63, 16, 51, 2451, 224, 64, 16, 52, 2715, 236, 67, 16, 55, 2806, 240, 68, 16, 56, 3088, 252, 71, 16, 59, 3185, 256, 72, 16, 60, 3485, 
            268, 75, 16, 63, 3588, 272, 76, 16, 64, 3906, 284, 79, 16, 67, 4015, 288, 80, 16, 68, 4351, 300, 83, 16, 71, 4466, 304, 84, 16, 72, 4820, 316, 87, 16, 75, 4941, 320, 88, 16, 76, 5313, 332, 91, 16, 79, 5440, 336, 92, 16, 80, 5830, 348, 95, 16, 83, 5963, 352, 96, 16, 84, 6371, 364, 99, 16, 87, 6510, 368, 100, 16, 88, 6936, 380, 103, 16, 91, 7081, 384, 104, 16, 92, 7525, 396, 107, 16, 95, 7676, 400, 108, 16, 96, 8138, 412, 111, 16, 99, 8295, 416, 112, 16, 100, 64, 36, 20, 20, 4, 416, 100, 36, 20, 20, 1296, 185, 58, 21, 41, 175, 66, 29, 22, 11, 45, 32, 22, 24, 2, 120, 56, 28, 24, 8, 536, 130, 48, 26, 26, 980, 178, 60, 26, 38, 12750, 671, 184, 27, 161, 220, 84, 38, 28, 14, 352, 108, 44, 28, 20, 9472, 588, 164, 28, 140, 81, 50, 31, 30, 5, 148, 70, 36, 30, 10, 216, 86, 40, 30, 14, 1863, 266, 85, 30, 59, 119, 64, 36, 32, 8, 250, 96, 44, 32, 16, 1625, 256, 84, 32, 56, 1288, 234, 80, 34, 50, 96, 60, 38, 36, 6, 120, 68, 40, 36, 8, 456, 140, 58, 36, 26, 736, 180, 68, 36, 36, 5376, 500, 148, 36, 116, 17500, 921, 254, 37, 221, 276, 110, 52, 38, 18, 1818, 299, 100, 39, 65, 88, 60, 41, 40, 5, 147, 80, 46, 40, 10, 205, 96, 50, 40, 14, 392, 136, 60, 40, 24, 1519, 276, 95, 40, 59, 2548, 360, 116, 40, 80, 100, 66, 44, 42, 6, 651, 182, 73, 42, 35, 5500, 546, 164, 42, 126, 148, 84, 50, 44, 10, 896, 220, 84, 44, 44, 8576, 700, 204, 44, 164, 14848, 924, 260, 44, 220, 85, 64, 48, 48, 4, 126, 80, 52, 48, 8, 297, 128, 64, 48, 20, 540, 176, 76, 48, 32, 1701, 320, 112, 48, 68, 246, 119, 64, 51, 17, 3186, 455, 148, 51, 101, 400, 156, 74, 52, 26, 3304, 468, 152, 52, 104, 4000, 516, 164, 52, 116, 1065, 266, 103, 54, 53, 111, 80, 58, 56, 6, 121, 84, 59, 56, 7, 1136, 280, 108, 56, 56, 1331, 304, 114, 56, 62, 6776, 700, 213, 56, 161, 11616, 920, 268, 56, 216, 616, 205, 90, 57, 37, 10051, 870, 257, 58, 203, 23276, 1330, 372, 58, 318, 96, 76, 60, 60, 4, 288, 140, 76, 60, 20, 441, 176, 85, 60, 29, 672, 220, 96, 60, 40, 768, 236, 100, 60, 44, 2080, 396, 140, 60, 84, 15456, 1100, 316, 60, 260, 25025, 1426, 399, 62, 341, 490, 192, 92, 64, 32, 845, 256, 108, 64, 48, 5618, 685, 216, 65, 155, 171, 110, 73, 66, 11, 301, 150, 83, 66, 21, 4131, 590, 193, 66, 131, 245, 136, 81, 68, 17, 5240, 676, 216, 68, 152, 208, 126, 80, 70, 14, 99, 84, 71, 72, 3, 125, 96, 74, 72, 6, 144, 104, 76, 72, 8, 246, 140, 85, 72, 17, 344, 168, 92, 72, 24, 375, 176, 94, 72, 26, 1275, 336, 134, 72, 66, 1716, 392, 148, 72, 80, 8625, 896, 274, 72, 206, 976, 300, 128, 76, 56, 1536, 380, 148, 76, 76, 14848, 1212, 356, 76, 284, 6480, 806, 256, 78, 182, 19965, 1426, 411, 78, 337, 115, 96, 80, 80, 4, 287, 160, 96, 80, 20, 689, 256, 120, 80, 44, 1156, 336, 140, 80, 64, 7514, 880, 276, 80, 200, 27455, 1696, 480, 80, 404, 625, 246, 119, 82, 41, 3136, 570, 200, 82, 122, 38875, 2046, 569, 82, 491, 205, 136, 93, 84, 13, 216, 140, 94, 84, 14, 288, 164, 100, 84, 20, 2160, 476, 178, 84, 98, 3520, 612, 212, 84, 132, 460, 216, 116, 88, 32, 2527, 528, 194, 88, 110, 169, 126, 95, 90, 9, 507, 230, 121, 90, 35, 1825, 456, 179, 92, 91, 5832, 833, 274, 93, 185, 1344, 395, 166, 95, 75, 165, 128, 100, 
            96, 8, 246, 160, 108, 96, 16, 343, 192, 116, 96, 24, 441, 220, 123, 96, 31, 891, 320, 148, 96, 56, 1470, 416, 172, 96, 80, 3381, 640, 228, 96, 136, 24696, 1760, 508, 96, 416, 344, 196, 120, 100, 24, 3872, 700, 246, 100, 150, 33664, 2100, 596, 100, 500, 9504, 1118, 352, 102, 254, 1058, 364, 165, 104, 65, 10580, 1192, 372, 104, 272, 3060, 644, 238, 108, 134, 4992, 828, 284, 108, 180, 196, 150, 116, 110, 10, 301, 192, 128, 112, 20, 850, 336, 164, 112, 56, 5625, 896, 304, 112, 196, 540, 266, 148, 114, 38, 1716, 490, 204, 114, 94, 2336, 580, 228, 116, 116, 162, 140, 121, 120, 5, 196, 156, 125, 120, 9, 243, 176, 130, 120, 14, 495, 260, 151, 120, 35, 729, 320, 166, 120, 50, 1197, 416, 190, 120, 74, 1944, 536, 220, 120, 104, 176, 150, 128, 126, 6, 936, 374, 184, 126, 62, 3741, 770, 283, 126, 161, 225, 176, 139, 132, 11, 784, 348, 182, 132, 54, 276, 200, 148, 136, 16, 320, 220, 156, 140, 20, 210, 176, 148, 144, 8, 245, 192, 152, 144, 12, 621, 320, 184, 144, 44, 1331, 480, 224, 144, 84, 539, 304, 186, 152, 38, 800, 376, 204, 152, 56, 256, 204, 164, 156, 12, 396, 260, 178, 156, 26, 540, 308, 190, 156, 38, 736, 364, 204, 156, 52, 1711, 576, 260, 160, 104, 495, 304, 198, 168, 34, 507, 308, 199, 168, 35, 676, 360, 212, 168, 48, 1300, 516, 254, 172, 86, 690, 371, 220, 175, 49, 266, 220, 183, 176, 11, 392, 276, 200, 180, 24, 1176, 500, 256, 180, 80, 289, 234, 191, 182, 13, 460, 306, 212, 186, 30, 325, 256, 204, 192, 16, 486, 320, 220, 192, 32, 1275, 546, 281, 198, 87, 305, 256, 216, 208, 12, 735, 416, 256, 208, 52, 324, 266, 220, 210, 14, 736, 420, 260, 212, 52, 1156, 540, 293, 216, 81, 640, 396, 260, 220, 44, 726, 425, 268, 221, 51, 690, 416, 268, 224, 48, 273, 256, 240, 240, 4, 1128, 560, 316, 240, 80, 300, 276, 254, 252, 6, 343, 304, 270, 264, 10, 1081, 594, 359, 286, 77, 351, 320, 292, 288, 8, 1127, 640, 396, 320, 80)

t=24 # t=23
n=0.5*t*(t+1)
mat_miu=matrix(miu_array,ncol=5,byrow=T)
data_miu=data.frame(mat_miu)
names(data_miu)=c('Ni','kii','ei','fi','lambdai')
ni= data_miu[,'Ni'] #vector of ni
k=data_miu[,'kii']
f=data_miu[,'fi']

#generate vector of unique ni
v=NULL #empty matrix or vector
#Inf
for(n in (0.5*t*(t+1))){
  for(i in 1:(length(ni))){
    for(j in (i):length(ni)){
      if(ni[i]+ni[j]==n){
        if(ni[i]%in%v){
          if(ni[j]%in%v){}
          else{v=c(v,ni[j])}
        }else(
          if(ni[j]%in%v){v=c(v,ni[i])}
          else{v=c(v,c(ni[i],ni[j]))})
      }
    }
  }
}

v #unique ni

#subset of mat_miu
subset_dat=NULL
for(i in v){subset_dat=rbind(subset_dat,subset(data_miu,Ni==i))}
subset_dat
dim(subset_dat)

#add a new dataframe with n1,n2
v1=subset_dat$Ni
len=length(v1)
subset_dat1=NULL
for(i in 1:(len-1)){
  for(j in (i+1):len){
    if(v1[i]+v1[j]==n){subset_dat1=rbind(subset_dat1,c(subset_dat$Ni[i],subset_dat$Ni[j],subset_dat$kii[i],subset_dat$kii[j],subset_dat$ei[i],subset_dat$ei[j],subset_dat$fi[i],subset_dat$fi[j],subset_dat$lambdai[i],subset_dat$lambdai[j]))}
  }
} 
subset_dat1
colnames(subset_dat1)=c('n1','n2','k11','k22','e1','e2','f1','f2','lambda1','lambda2')
subset_dat1

#add lambda
lambda=subset_dat1[,'lambda1']+subset_dat1[,'lambda2']-mu
subset=cbind(subset_dat1,lambda)
subset

#add p
p=-( (t-1)*lambda+0.5*t*(t-1)*mu)
subset=cbind(subset,p)
subset

#check p+mu==k11+k22
check=(p+mu==subset[,'k11']+subset[,'k22'])
subset=cbind(subset,check)
#zero if contradiction holds
#check it is a valid SRG

k21=sqrt((subset_dat1[,'k11']*subset_dat1[,'k22']-p*mu)*subset_dat1[,'n1']/subset_dat1[,'n2'])
subset=cbind(subset,k21)
subset
